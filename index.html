<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>セルフチェック LITE（説明つき・保存なし）</title>
<style>
  :root{--bg:#0f1115;--card:#17181c;--ink:#e9eef5;--muted:#aab3c2;--accent:#3aaed8;--good:#36c26e;--warn:#f5a524;--bad:#ff4d4f;--info:#4da3ff;--bd:#2a2d36}
  *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Hiragino Kaku Gothic ProN","Noto Sans JP",Meiryo,sans-serif}
  header{position:sticky;top:0;z-index:10;background:#14161b;backdrop-filter:blur(8px);border-bottom:1px solid var(--bd);padding:.9rem 1rem}
  h1{font-size:1.1rem;margin:0}.lead{color:var(--muted);font-size:.9rem;margin-top:.3rem}
  main{max-width:960px;margin:0 auto;padding:1rem}
  .tabs{display:flex;gap:.5rem;flex-wrap:wrap;margin:.6rem 0}
  .tab{border:1px solid var(--bd);background:#1e232b;color:var(--ink);border-radius:999px;padding:.45rem .8rem;font-weight:700;cursor:pointer}
  .tab.active{background:var(--accent);color:#071018;border-color:transparent}
  .pane{display:none}.pane.active{display:block}
  .card{background:var(--card);border:1px solid var(--bd);border-radius:12px;padding:1rem;margin:.8rem 0}
  .checks{display:grid;grid-template-columns:1fr;gap:.5rem}
  @media(min-width:720px){.checks{grid-template-columns:1fr 1fr}}
  .check{display:flex;flex-direction:column;gap:.35rem;border:1px solid var(--bd);border-radius:10px;padding:.6rem .8rem;background:#12141a}
  .check > .row{display:flex;gap:.6rem;align-items:flex-start}
  .status{display:flex;gap:.7rem;align-items:flex-start;border:1px solid var(--bd);border-radius:10px;padding:.8rem;background:#101219}
  .badge{font-weight:800;border-radius:999px;padding:.2rem .55rem}
  .ok{background:var(--good);color:#031}.inf{background:var(--info);color:#021}.wrn{background:var(--warn);color:#111}.bad{background:var(--bad);color:#111}
  .hint{color:var(--muted);font-size:.9rem}
  details.hint{margin-left:1.95rem;font-size:.85rem}
  details.hint summary{cursor:pointer;color:var(--accent);user-select:none}
  .toolbar{display:flex;gap:.6rem;flex-wrap:wrap}
  button,.btn{border:1px solid var(--bd);border-radius:10px;padding:.6rem .9rem;background:#1e232b;color:var(--ink);font-weight:700;cursor:pointer}
  .primary{background:var(--accent);color:#071018;border-color:transparent}
  .mono{font-family:ui-monospace,Menlo,Consolas,monospace;white-space:pre-wrap}
  @media print{header,.tabs,.no-print{display:none!important} body{background:#fff;color:#000}}
</style>
</head>
<body>
<header>
  <h1>野球選手向け セルフチェック LITE（説明つき）</h1>
  <div class="lead">受診の是非に迷うときの参考用。保存なし・個人情報入力なし。各項目の「説明」をタップで補足を表示。</div>
</header>

<main>
  <div class="tabs no-print">
    <button class="tab active" data-pane="L">腰</button>
    <button class="tab" data-pane="S">肩</button>
    <button class="tab" data-pane="E">肘</button>
    <button class="tab" data-pane="A">足首</button>
    <button class="btn" onclick="window.print()">PDFに書き出す</button>
  </div>

  <!-- ===== 腰 ===== -->
  <section id="pane-L" class="pane active" data-scope="L">
    <div class="card">
      <div class="status">
        <span class="badge ok" data-badge>様子観察（所見なし）</span>
        <div>
          <div data-text>チェックを入れると自動判定します。</div>
          <div class="hint" data-play>参加目安：全面参加可（痛みゼロ／可動域正常）</div>
          <div class="mono" data-summary style="margin-top:.4rem"></div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="checks">
        <label class="check">
          <div class="row"><input type="checkbox" data-group="hernia" data-w="3"><span>下肢への放散痛・しびれ</span></div>
          <details class="hint"><summary>説明</summary><div>椎間板ヘルニアなどで神経根が刺激されると、腰〜臀部〜脚へ電撃様の痛みやしびれが走ります。前屈・座位長時間・くしゃみで悪化しやすい所見です。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="spondy" data-w="3"><span>反り（伸展）で痛む</span></div>
          <details class="hint"><summary>説明</summary><div>伸展・回旋で疼痛が増悪する場合、腰椎分離（ストレス反応〜分離）や椎間関節性痛の示唆になります。片脚後屈でも再現しやすい。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="acute" data-w="2"><span>急な発症／姿勢保持困難</span></div>
          <details class="hint"><summary>説明</summary><div>いわゆる急性腰痛。筋・筋膜や椎間関節の急性障害で、防御性の前屈保持や動作回避が見られます。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="red" data-w="6"><span>膀胱直腸障害・鞍部感覚低下</span></div>
          <details class="hint"><summary>説明</summary><div>馬尾症候群を疑う強いレッドフラッグ。排尿困難/失禁、会陰部の感覚低下、両下肢の麻痺などがあれば緊急受診が必要です。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="load" data-w="2"><span>走・投・打の負荷スパイク（30％↑）</span></div>
          <details class="hint"><summary>説明</summary><div>前週比で急な練習量増は過負荷リスク。症状が軽微でも一段階厳しめに判定し、24–72時間の再評価を推奨します。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-none data-group="any"><span>特になし（他と排他）</span></div>
          <details class="hint"><summary>説明</summary><div>このカード内の他のチェックを全てオフにする安全装置です。迷ったときに使ってください。</div></details>
        </label>
      </div>
    </div>
    <div class="card no-print"><div class="toolbar">
      <button class="primary" data-copy>結果をコピー</button>
      <button data-reset>判定をリセット</button>
    </div></div>
  </section>

  <!-- ===== 肩 ===== -->
  <section id="pane-S" class="pane" data-scope="S">
    <div class="card">
      <div class="status">
        <span class="badge ok" data-badge>様子観察（所見なし）</span>
        <div>
          <div data-text>チェックで自動判定。</div>
          <div class="hint" data-play>参加目安：全面参加可</div>
          <div class="mono" data-summary style="margin-top:.4rem"></div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="checks">
        <label class="check">
          <div class="row"><input type="checkbox" data-group="rc" data-w="2"><span>ペインフルアーク（60–120°）</span></div>
          <details class="hint"><summary>説明</summary><div>外転60–120°の途中でのみ痛む場合、回旋腱板炎や肩峰下インピンジメントの典型所見です。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="imp" data-w="2"><span>レイトコッキングで後方肩痛</span></div>
          <details class="hint"><summary>説明</summary><div>90°外転＋外旋終末域での後方痛は内部衝突（後上方インピンジメント）や後方タイトネスの示唆になります。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="slap" data-w="2"><span>クリック音／前方肩痛</span></div>
          <details class="hint"><summary>説明</summary><div>上腕二頭筋長頭腱や上方関節唇（SLAP）病変で、引っかかり音や前方痛が出やすくなります。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="red" data-w="6"><span>変形・強い神経/血流サイン</span></div>
          <details class="hint"><summary>説明</summary><div>脱臼・骨折の疑い、手の蒼白/冷感/脈触知困難、感覚消失などは救急受診レベルのレッドフラッグです。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="load" data-w="2"><span>投球量の急増（30％↑）</span></div>
          <details class="hint"><summary>説明</summary><div>短期間の球数・強度の急増は腱板や関節唇への負担増。保守的に評価し段階復帰を徹底します。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-none data-group="any"><span>特になし（他と排他）</span></div>
          <details class="hint"><summary>説明</summary><div>このカードの他項目をすべてオフにします。セルフチェックのリセット用途。</div></details>
        </label>
      </div>
    </div>
    <div class="card no-print"><div class="toolbar">
      <button class="primary" data-copy>結果をコピー</button>
      <button data-reset>判定をリセット</button>
    </div></div>
  </section>

  <!-- ===== 肘 ===== -->
  <section id="pane-E" class="pane" data-scope="E">
    <div class="card">
      <div class="status">
        <span class="badge ok" data-badge>様子観察（所見なし）</span>
        <div>
          <div data-text>チェックで自動判定。</div>
          <div class="hint" data-play>参加目安：全面参加可</div>
          <div class="mono" data-summary style="margin-top:.4rem"></div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="checks">
        <label class="check">
          <div class="row"><input type="checkbox" data-group="ucl" data-w="3"><span>外反ストレスで内側痛</span></div>
          <details class="hint"><summary>説明</summary><div>投球時の外反ストレスで出る内側痛はUCLストレインのサイン。内側上顆付近の限局圧痛を伴うことが多いです。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="lat" data-w="3"><span>小頭部局所痛／ロック感</span></div>
          <details class="hint"><summary>説明</summary><div>上腕骨小頭の圧痛やクリック・ロックは離断性骨軟骨炎（OCD）など外側病変の可能性を示唆します。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="ner" data-w="2"><span>小指・環指のしびれ</span></div>
          <details class="hint"><summary>説明</summary><div>尺骨神経の症状（肘部管）。タッピングで誘発され、握力低下や巧緻性低下を伴うことがあります。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="red" data-w="6"><span>変形・関節ロック・蒼白</span></div>
          <details class="hint"><summary>説明</summary><div>脱臼・骨折や血流障害を示す可能性。動かせないロック感や蒼白・冷感は至急対応が必要です。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="load" data-w="2"><span>投球量の急増（30％↑）</span></div>
          <details class="hint"><summary>説明</summary><div>短期の球数増は内外側の組織に負担。軽症でも評価を一段階厳しくして再評価間隔を短くします。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-none data-group="any"><span>特になし（他と排他）</span></div>
          <details class="hint"><summary>説明</summary><div>このカードの他チェックを全オフにして初期状態へ戻します。</div></details>
        </label>
      </div>
    </div>
    <div class="card no-print"><div class="toolbar">
      <button class="primary" data-copy>結果をコピー</button>
      <button data-reset>判定をリセット</button>
    </div></div>
  </section>

  <!-- ===== 足首 ===== -->
  <section id="pane-A" class="pane" data-scope="A">
    <div class="card">
      <div class="status">
        <span class="badge ok" data-badge>様子観察（所見なし）</span>
        <div>
          <div data-text>チェックで自動判定。</div>
          <div class="hint" data-play>参加目安：全面参加可</div>
          <div class="mono" data-summary style="margin-top:.4rem"></div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="checks">
        <label class="check">
          <div class="row"><input type="checkbox" data-group="spr" data-w="2"><span>内反で痛む／外果前方圧痛</span></div>
          <details class="hint"><summary>説明</summary><div>外側靱帯（ATFLなど）の捻挫所見。内反動作や荷重で痛みが増し、外果前下に圧痛点があることが多いです。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="mob" data-w="2"><span>背屈不足（ニー・トゥ・ウォール左右差）</span></div>
          <details class="hint"><summary>説明</summary><div>背屈可動域の低下は着地衝撃吸収の不足や足部アライメント不良につながり、反復痛の温床になります。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="red" data-w="6"><span>荷重不可・変形・蒼白</span></div>
          <details class="hint"><summary>説明</summary><div>骨折・脱臼・血流障害の可能性。4歩以上歩けない、強い一点圧痛、蒼白/しびれがあれば緊急受診。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-group="load" data-w="2"><span>走量/ダッシュ急増（30％↑）</span></div>
          <details class="hint"><summary>説明</summary><div>走行距離や方向転換の急増は足関節周囲の過負荷を招きます。段階的負荷と再評価が必須です。</div></details>
        </label>
        <label class="check">
          <div class="row"><input type="checkbox" data-none data-group="any"><span>特になし（他と排他）</span></div>
          <details class="hint"><summary>説明</summary><div>このカードの他チェックをオフにしてリセットします。</div></details>
        </label>
      </div>
    </div>
    <div class="card no-print"><div class="toolbar">
      <button class="primary" data-copy>結果をコピー</button>
      <button data-reset>判定をリセット</button>
    </div></div>
  </section>

  <footer class="card">免責：教育・啓発目的の参考情報。診断・治療ではありません。緊急サインがあれば速やかに受診してください。</footer>
</main>

<script>
(function(){
  // タブ切替（イベント委譲）
  document.querySelector('.tabs').addEventListener('click', e=>{
    const b = e.target.closest('.tab'); if(!b) return;
    document.querySelectorAll('.tab').forEach(t=>t.classList.toggle('active', t===b));
    const pane = b.dataset.pane;
    document.querySelectorAll('.pane').forEach(p=>p.classList.toggle('active', p.id==='pane-'+pane));
  });

  // 共通ロジック
  const LABELS = ['様子観察（所見なし）','経過観察（セルフケア）','受診検討','受診推奨'];
  const CLASSN = ['ok','inf','wrn','bad'];

  function calcLevel(scope){
    const root = document.querySelector(`[data-scope="${scope}"]`);
    const on = root.querySelectorAll('.checks input[type="checkbox"]:checked:not([data-none])');
    let score = 0;
    let flags = {critical:false, red:false, load:false};
    on.forEach(cb=>{
      const w = +cb.dataset.w || 1;
      score += w;
      const g = cb.dataset.group || '';
      if(g==='red' && w>=6) flags.critical = true;
      else if(g==='red')     flags.red = true;
      if(g==='load')         flags.load = true;
    });
    if(flags.critical) return 3;
    let level = score===0?0 : score<=2?1 : score<=5?2 : 3;
    if(flags.red && level<2) level = 2;
    if(flags.load && level<2) level = 2;
    return level;
  }

  function render(scope){
    const root = document.querySelector(`[data-scope="${scope}"]`);
    const level = calcLevel(scope);
    const badge = root.querySelector('[data-badge]');
    const text  = root.querySelector('[data-text]');
    const play  = root.querySelector('[data-play]');
    const sum   = root.querySelector('[data-summary]');

    CLASSN.forEach(c=>badge.classList.remove(c));
    badge.classList.add(CLASSN[level]);
    badge.textContent = LABELS[level];

    const advice = [
      '該当なし：セルフケアで様子観察。',
      'セルフケア中心：痛みゼロ条件で段階復帰。24–72hで再評価。',
      '受診検討：症状持続/強化、典型パターンの疑いあり。',
      '受診推奨：強いレッドフラッグ。できるだけ早く受診。'
    ][level];
    const playGuide = [
      '参加目安：全面参加可（痛みゼロ／可動域正常）',
      '参加目安：制限付き参加。24–72時間で再評価。',
      '参加目安：練習中止。軽負荷リハのみ。',
      '参加目安：競技中止。至急受診。'
    ][level];
    text.textContent = advice;
    play.textContent = playGuide;

    const now = new Date();
    const ds = now.toLocaleDateString('ja-JP');
    const ts = now.toLocaleTimeString('ja-JP',{hour:'2-digit',minute:'2-digit'});
    const title = {L:'腰部',S:'肩',E:'肘',A:'足首'}[scope];
    const onLabels = Array.from(root.querySelectorAll('.checks input[type="checkbox"]:checked:not([data-none])'))
                      .map(cb=>cb.closest('label').querySelector('.row span').innerText.trim());
    const sumText =
`【${title}セルフチェック LITE】
日時：${ds} ${ts}
判定：${LABELS[level]}
指針：${advice}
参加目安：${playGuide}
チェック項目：
- ${onLabels.join('\n- ') || '（なし）'}`;
    sum.textContent = sumText;
  }

  // 変更イベント（排他含む）
  document.addEventListener('change', e=>{
    const cb = e.target;
    if(cb.matches('input[type="checkbox"][data-none]')){
      const wrap = cb.closest('.card');
      wrap.querySelectorAll('input[type="checkbox"]:not([data-none])').forEach(x=>x.checked=false);
    } else if(cb.matches('input[type="checkbox"]')){
      const wrap = cb.closest('.card');
      const none = wrap.querySelector('input[type="checkbox"][data-none]');
      if(none && cb.checked) none.checked=false;
    } else { return; }
    const pane = cb.closest('.pane');
    const scope = pane?.dataset.scope;
    if(scope) render(scope);
  });

  // ボタン：コピー/リセット
  document.addEventListener('click', e=>{
    const btn = e.target.closest('button'); if(!btn) return;
    const pane = btn.closest('.pane'); const scope = pane?.dataset.scope;
    if(btn.matches('[data-reset]')){
      pane.querySelectorAll('input[type="checkbox"]').forEach(x=>x.checked=false);
      render(scope);
    }
    if(btn.matches('[data-copy]')){
      const text = pane.querySelector('[data-summary]')?.textContent || '';
      if(navigator.clipboard?.writeText){ navigator.clipboard.writeText(text).then(()=>alert('結果をコピーしました。')); }
      else { const ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); alert('結果をコピーしました。'); }
    }
  });

  // 初期レンダ
  ['L','S','E','A'].forEach(render);
})();
</script>
</body>
</html>
